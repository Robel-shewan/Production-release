(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[7376],{17376:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>G}),n(14078),n(95623),n(61514);var r=n(14680),a=n.n(r),l=n(84390),o=n.n(l),c=n(70314),p=n(97042),i=n(4586),s=n(19601),u=n(84073),d=n(33643),m=n(23712),_=n(49562),b=(n(61418),n(72060)),v=n(54146),f=n(66900),E=n(11298),g=n(30961),I=n(34575),N=n(98831);const h=e=>Boolean(null==e?void 0:e.app_id),k=e=>{const{binding:t}=e,n=(0,c.useDispatch)(),r=(0,b.useIntl)(),a=(0,c.useSelector)(f.gO),l=(0,c.useSelector)(E.ev),p="app-bar-icon-".concat(t.app_id),i=t.label||t.app_id;return o().createElement(I.Z,{id:"tooltip-"+p,title:i,placement:"left"},o().createElement("div",{id:p,"aria-label":i,className:"app-bar__icon",onClick:async()=>{const e=(0,N.qM)(t.app_id,t.location,a,l),o=await n((0,g.eL)(t,e,r));if(o.error){const t=o.error.text||"An error occurred";return void n((0,g.J3)(o.error,t,e))}const c=o.data;switch(c.type){case v.Bp.OK:return void(c.text&&n((0,g.J3)(c,c.text,e)));case v.Bp.FORM:return void(c.form&&n((0,g.HN)(c.form,e)));case v.Bp.NAVIGATE:return;default:{const t=r.formatMessage({id:"apps.error.responses.unknown_type",defaultMessage:"App response type not supported. Response type: {type}."},{type:c.type});n((0,g.J3)(c,t,e))}}}},o().createElement("div",{className:"app-bar__icon-inner"},o().createElement("img",{src:t.icon}))))};var x=n(45448),O=n(40364),S=n(60233);const y=()=>{const{formatMessage:e}=(0,b.useIntl)(),t=(0,c.useDispatch)(),n=(0,l.useCallback)((()=>{t((0,O.h)({modalId:m.r8.PLUGIN_MARKETPLACE,dialogType:S.Z,dialogProps:{openedFrom:"app_bar"}}))}),[t]),r=e({id:"app_bar.marketplace",defaultMessage:"App Marketplace"});return o().createElement(I.Z,{id:"tooltip-app-bar-marketplace",title:r,placement:"left"},o().createElement("button",{key:"app_bar_marketplace",className:"app_bar__marketplace_button","aria-label":r,onClick:n},o().createElement(x.ViewGridPlusOutlineIcon,{size:18})))};var A=n(60042),w=n.n(A),R=n(43618),L=n(84459),C=n(62165),D=n(31775),M=function(e){return e.LOADING="loading",e.LOADED="loaded",e.ERROR="error",e}(M||{});const T=e=>Boolean((null==e?void 0:e.id)&&(null==e?void 0:e.pluginId)),B=e=>{const{component:t}=e,n=(0,c.useSelector)(R.TB),r=(0,c.useSelector)(R.HU),a=(0,c.useSelector)(L.tx),[p,i]=(0,l.useState)(M.LOADING);(0,l.useEffect)((()=>{i(M.LOADING)}),[t.iconUrl]);const s="app-bar-icon-".concat(t.pluginId),u=t.tooltipText||t.dropdownText||t.pluginId,d=t.iconUrl;let _=o().createElement("div",{role:"button",tabIndex:0,className:"app-bar__icon-inner"},o().createElement("img",{src:d,alt:t.pluginId,onLoad:()=>{i(M.LOADED)},onError:()=>{i(M.ERROR)}}));const b=t.rhsComponentId?(null==a?void 0:a.id)===t.rhsComponentId:t.pluginId===(null==a?void 0:a.pluginId);d||(_=o().createElement("div",{role:"button",tabIndex:0,className:w()("app-bar__old-icon app-bar__icon-inner app-bar__icon-inner--centered",{"app-bar__old-icon--active":b})},t.icon)),p===M.ERROR&&(_=o().createElement(C.Z,{className:"icon__plugin"}));const v=t.pluginId===m.iw.focalboard;return o().createElement(I.Z,{id:"pluginTooltip-"+s,title:u,placement:"left"},o().createElement("div",{id:s,className:w()("app-bar__icon",{"app-bar__icon--active":b}),onClick:()=>{var e;null===(e=t.action)||void 0===e||e.call(t,n,r)}},_,v&&o().createElement(D.Z,null)))};function G(){const e=(0,c.useSelector)(d.x9),t=(0,c.useSelector)(d.f7),n=(0,c.useSelector)(i.Hf),r=(0,_.j2)(),l=(0,_.b7)(),b=(0,c.useSelector)(d.I3),v=(0,c.useSelector)((e=>(0,s.AN)(e)&&(0,u.ch)(e,p.Pl.SYSCONSOLE_WRITE_PLUGINS)));if(!b||r&&!r.showAppBar)return null;const f=[m.iw.focalboard,m.iw.playbooks],[E,g]=a()(t,(e=>{let{pluginId:t}=e;return f.includes(t)})),I=[...E,P(E.length,g.length+e.length+n.length),...g,...e,...n].map((e=>{return e?T(e)?(0,_.KK)(null!==(t=e.supportedProductIds)&&void 0!==t?t:null,l,null==r?void 0:r.pluginId)?o().createElement(B,{key:e.id,component:e}):null:h(e)?(0,_.KK)(null!==(n=e.supported_product_ids)&&void 0!==n?n:null,l,null==r?void 0:r.pluginId)?o().createElement(k,{key:"".concat(e.app_id,"_").concat(e.label),binding:e}):null:e:e;var t,n}));return o().createElement("div",{className:"app-bar"},o().createElement("div",{className:"app-bar__top"},I),v&&o().createElement("div",{className:"app-bar__bottom"},o().createElement(y,null)))}const P=(e,t)=>e&&t?o().createElement("hr",{key:"divider",className:"app-bar__divider"}):null},66503:e=>{e.exports=function(e,t,n,r){for(var a=-1,l=null==e?0:e.length;++a<l;){var o=e[a];t(r,o,n(o),e)}return r}},60426:(e,t,n)=>{var r=n(52033);e.exports=function(e,t,n,a){return r(e,(function(e,r,l){t(a,e,n(e),l)})),a}},52033:(e,t,n)=>{var r=n(26194),a=n(26789)(r);e.exports=a},34690:(e,t,n)=>{var r=n(66503),a=n(60426),l=n(89278),o=n(19785);e.exports=function(e,t){return function(n,c){var p=o(n)?r:a,i=t?t():{};return p(n,e,l(c,2),i)}}},26789:(e,t,n)=>{var r=n(80068);e.exports=function(e,t){return function(n,a){if(null==n)return n;if(!r(n))return e(n,a);for(var l=n.length,o=t?l:-1,c=Object(n);(t?o--:++o<l)&&!1!==a(c[o],o,c););return n}}},14680:(e,t,n)=>{var r=n(34690)((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));e.exports=r}}]);
//# sourceMappingURL=7376.3df1ceb7b73a4fb2b67b.js.map