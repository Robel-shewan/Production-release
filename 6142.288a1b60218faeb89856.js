(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[6142],{47800:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i}),s(14078);var n=s(84390);const a=4e3;function i(e){const[t,s]=(0,n.useState)(!1),[i,r]=(0,n.useState)(!1),l=(0,n.useRef)(null);let o=a;return(e.successCopyTimeout||0===e.successCopyTimeout)&&(o=e.successCopyTimeout),{copiedRecently:t,copyError:i,onClick:(0,n.useCallback)((()=>{e.trackCallback&&e.trackCallback(),l.current&&(clearTimeout(l.current),l.current=null);const t=navigator.clipboard;if(t)t.writeText(e.text).then((()=>{s(!0),r(!1)})).catch((()=>{s(!1),r(!0)}));else{const t=document.createElement("textarea");t.innerText=e.text,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select();try{const e=document.execCommand("copy");s(e),r(!e)}catch(e){s(!1),r(!0)}t.remove()}l.current=setTimeout((()=>{s(!1),r(!1)}),o)}),[e.text,o])}}},40455:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var n=s(84390),a=s.n(n),i=s(72060);function r(e){const{formatMessage:t}=(0,i.useIntl)();return a().createElement("span",e,a().createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",role:"img","aria-label":t({id:"generic_icons.mail",defaultMessage:"Mail Icon"})},a().createElement("path",{d:"M4,4H20A2,2 0 0,1 22,6V18A2,2 0 0,1 20,20H4C2.89,20 2,19.1 2,18V6C2,4.89 2.89,4 4,4M12,11L20,6H4L12,11M4,18H20V8.37L12,13.36L4,8.37V18Z"})))}},29614:(e,t,s)=>{"use strict";s.d(t,{Z:()=>j}),s(48410),s(61418),s(14078),s(52077),s(1203),s(72482),s(73902),s(11620),s(92189);var n=s(60042),a=s.n(n),i=s(84390),r=s.n(i),l=s(72060),o=s(65485),u=(s(99073),s(69372),s(5026),s(5301)),p=(s(34086),s(4427),s(11213)),c=(0,s(25698).Vn)(u.b),h=(0,u.a)(c);const m=(0,p.r7)(h);var d=s(80139),g=s(65370),f=s(33115),v=s(2664),b=s(68967),E=s(40455);function y(e){const{formatMessage:t}=(0,l.useIntl)();return r().createElement("span",e,r().createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",role:"img","aria-label":t({id:"generic_icons.add-mail",defaultMessage:"Add Mail Icon"})},r().createElement("path",{d:"M3,4C1.89,4 1,4.89 1,6V18A2,2 0 0,0 3,20H14V18H3V8.37L11,13.36L19,8.37V13H21V6A2,2 0 0,0 19,4H3M3,6H19L11,11L3,6M19,15V18H16V20H19V23H21V20H24V18H21V15H19Z"})))}var M=s(26337),V=s(56859),C=s(90186),O=s(11832),w=s(70174);function P(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function x(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?P(Object(s),!0).forEach((function(t){I(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):P(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function I(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const _=/[\s,;]+/,L=(0,l.defineMessages)({loadingDefault:{id:"widgets.users_emails_input.loading",defaultMessage:"Loading"},noMatchDefault:{id:"widgets.users_emails_input.no_user_found_matching",defaultMessage:"No one found matching **{text}**. Enter their email to invite them."},validAddressDefault:{id:"widgets.users_emails_input.valid_email",defaultMessage:"Add **{email}**"}});class j extends r().PureComponent{constructor(e){super(e),I(this,"renderUserName",(e=>{const t=(0,w.H6)(e);let s=null;t.fullName&&(s=r().createElement("span",{className:"fullname"},t.fullName));let n=null;return t.nickname&&(n=r().createElement("span",{className:"nickname"},t.nickname)),r().createElement(r().Fragment,null,t.displayName,s,n)})),I(this,"loadingMessage",(()=>{const e=r().createElement(l.FormattedMessage,this.props.loadingMessage);return r().createElement(M.Z,{text:e})})),I(this,"getOptionValue",(e=>this.isUserProfile(e)?e.id:e.value)),I(this,"formatOptionLabel",((e,t)=>{const s=(0,w.bb)(e.id,e.last_picture_update);let n=null,a=null;return e.is_bot&&(a=r().createElement(V.Z,null)),!(0,g.Jh)(e.value)&&(0,f.nJ)(e.roles)&&(n=r().createElement(C.Z,null)),"menu"===t.context?e.value&&(0,g.Jh)(e.value)?this.getCreateLabel(e.value):r().createElement(r().Fragment,null,r().createElement(O.Z,{size:"lg",username:e.username,url:s}),this.renderUserName(e),a,n):e.value&&(0,g.Jh)(e.value)?r().createElement(r().Fragment,null,r().createElement(E.Z,{className:"mail-icon"}),r().createElement("span",null,e.value)):r().createElement(r().Fragment,null,r().createElement(O.Z,{size:"sm",username:e.username,url:s}),(0,w.Gf)(e),a,n)})),I(this,"onChange",(e=>{this.props.onChange&&(e?this.props.onChange(e.map((e=>this.isUserProfile(e)?e:e.value))):this.props.onChange([]))})),I(this,"getCreateLabel",(e=>r().createElement(r().Fragment,null,r().createElement(y,{className:"mail-plus-icon"}),r().createElement(v.Z,Object.assign({key:"widgets.users_emails_input.valid_email"},this.props.validAddressMessage,{values:{email:e},disableLinks:!0}))))),I(this,"Input",(e=>r().createElement(o.H.Input,Object.assign({},e,{onPaste:e=>{var t;e.preventDefault();const s=(null===(t=e.clipboardData)||void 0===t?void 0:t.getData("Text"))||"";this.appendDelimitedValues(s),this.props.onPaste&&this.props.onPaste(e)}})))),I(this,"NoOptionsMessage",(e=>{const t=e.selectProps.inputValue;if(!t)return null;const s=o.H.NoOptionsMessage;return r().createElement("div",{className:"users-emails-input__option users-emails-input__option--no-matches"},r().createElement(s,e,r().createElement(v.Z,Object.assign({},this.props.noMatchMessage,{values:{text:t},disableLinks:!0}))))})),I(this,"MultiValueRemove",(e=>{let{children:t,innerProps:s}=e;return r().createElement("div",s,t||r().createElement(b.Z,null))})),I(this,"components",{NoOptionsMessage:this.props.suppressNoOptionsMessage?()=>null:this.NoOptionsMessage,MultiValueRemove:this.MultiValueRemove,IndicatorsContainer:()=>null,Input:this.Input}),I(this,"handleInputChange",(async(e,t)=>{if("input-blur"===t.action&&""!==e){const e=this.formatValuesForCreatable(),t=this.state.options.find((e=>this.props.inputValue===e.username||this.props.inputValue==="@"+e.username||this.props.inputValue===e.email));if(t)return this.onChange([...e,t]),void this.props.onInputChange("");if(this.props.emailInvitationsEnabled&&(0,g.Jh)(this.props.inputValue)){const t=this.props.inputValue;this.onChange([...e,{value:t,label:t}]),this.props.onInputChange("")}}else if("input-change"===t.action&&""!==e&&null!=e&&e[e.length-1].match(_)&&0===await this.appendDelimitedValues(e))return;"input-blur"!==t.action&&"menu-close"!==t.action&&this.props.onInputChange(e)})),I(this,"formatValuesForCreatable",(()=>this.props.value.map((e=>e.id?e:{label:e,value:e})))),I(this,"optionsLoader",((e,t)=>{const s=e=>{this.setState({options:e});const s=e.map((e=>x(x({},e),{},{label:e.username})));t(s),this.props.onUsersLoad&&this.props.onUsersLoad(e)},n=this.props.usersLoader(this.props.inputValue,s);n&&n.then&&n.then(s)})),I(this,"showAddEmail",((e,t,s)=>this.props.emailInvitationsEnabled&&0===s.length&&(0,g.Jh)(e))),I(this,"onFocus",(()=>{var e;null===(e=this.selectRef.current)||void 0===e||e.handleInputChange(this.props.inputValue,{action:"custom"})})),I(this,"onBlur",(()=>{var e;null===(e=this.selectRef.current)||void 0===e||e.handleInputChange(this.props.inputValue,{action:"input-blur"}),this.props.onBlur&&this.props.onBlur()})),I(this,"appendDelimitedValues",(async e=>{const t=this.formatValuesForCreatable(),s=[...new Set(e.split(_))];if(0===s.length)return 0;const n=(e,t)=>-1===e.findIndex((e=>this.isEmailInvite(e)&&e.value===t||this.isUserProfile(e)&&e.email===t)),a=async e=>n(t,e)?await this.searchByEmail(e)||e:null,i=(e,t)=>-1===e.findIndex((e=>this.isUserProfile(e)&&e.username===t)),r=async e=>i(t,e)?this.searchByUsername(e):null,l=s.map((async e=>{if(""===e)return Promise.resolve(null);let t;return t=this.props.emailInvitationsEnabled&&(0,g.Jh)(e)?await a(e):await r(e),"string"==typeof t?Promise.resolve({value:t,label:t}):this.isUserProfile(t)?Promise.resolve(t):Promise.resolve(null)})),o=[];return(await Promise.allSettled(l)).reduce(((e,t)=>("fulfilled"===t.status&&e.push(t.value),e)),[]).forEach((e=>{e&&(!this.isEmailInvite(e)||n(t,e.value)&&n(o,e.value))&&(!this.isUserProfile(e)||i(t,e.username)&&n(t,e.email)&&i(o,e.username)&&n(o,e.email))&&o.push(e)})),this.onChange([...t,...o]),this.props.onInputChange(""),o.length})),I(this,"isUserProfile",(e=>void 0!==e.id)),I(this,"isEmailInvite",(e=>void 0!==e.value)),I(this,"searchByEmail",(async e=>{var t;let s;try{s=await d.je.getUserByEmail(e)}catch(e){return null}return 0===(null===(t=s)||void 0===t?void 0:t.delete_at)?s:null})),I(this,"searchByUsername",(async e=>{var t;let s;try{s=await d.je.getUserByUsername(e)}catch(e){return null}return 0===(null===(t=s)||void 0===t?void 0:t.delete_at)?s:null})),this.selectRef=r().createRef(),this.state={options:[]}}render(){const e=this.formatValuesForCreatable(),t=o.H.NoOptionsMessage,s={placeholder:e=>x(x({},e),{},{pointerEvents:"none",userSelect:"none"}),input:e=>x(x({},e),{},{display:"flex",flex:"1 1 auto","> div":{width:"100%"},input:{width:"100% !important",textAlign:"left"}})};return r().createElement(r().Fragment,null,r().createElement(m,{ref:this.selectRef,onChange:this.onChange,loadOptions:this.optionsLoader,isValidNewOption:this.showAddEmail,isMulti:!0,isClearable:!1,className:a()("UsersEmailsInput",this.props.showError?"error":"",{empty:""===this.props.inputValue},{"no-selections":0===e.length}),classNamePrefix:"users-emails-input",placeholder:this.props.placeholder,components:this.components,getOptionValue:this.getOptionValue,formatOptionLabel:this.formatOptionLabel,defaultOptions:!1,defaultMenuIsOpen:!1,openMenuOnClick:!1,loadingMessage:this.loadingMessage,onInputChange:this.handleInputChange,inputValue:this.props.inputValue,openMenuOnFocus:!0,onFocus:this.onFocus,onBlur:this.onBlur,tabSelectsValue:!0,value:e,"aria-label":this.props.ariaLabel,autoFocus:this.props.autoFocus,styles:s}),this.props.showError&&r().createElement("div",{className:"InputErrorBox"},r().createElement(t,null,r().createElement(v.Z,Object.assign({},this.props.errorMessage,{values:this.props.errorMessageValues,disableLinks:!0}))),this.props.extraErrorText||null))}}I(j,"defaultProps",{noMatchMessage:L.noMatchDefault,validAddress:L.validAddressDefault,loadingMessage:L.loadingDefault,showError:!1})},32107:(e,t,s)=>{"use strict";var n=s(51695),a=s(59413),i=s(45089),r=s(98722),l=s(54522),o=s(94722);n({target:"Promise",stat:!0},{allSettled:function(e){var t=this,s=r.f(t),n=s.resolve,u=s.reject,p=l((function(){var s=i(t.resolve),r=[],l=0,u=1;o(e,(function(e){var i=l++,o=!1;u++,a(s,t,e).then((function(e){o||(o=!0,r[i]={status:"fulfilled",value:e},--u||n(r))}),(function(e){o||(o=!0,r[i]={status:"rejected",reason:e},--u||n(r))}))})),--u||n(r)}));return p.error&&u(p.value),s.promise}})},11620:(e,t,s)=>{s(32107)}}]);
//# sourceMappingURL=6142.288a1b60218faeb89856.js.map