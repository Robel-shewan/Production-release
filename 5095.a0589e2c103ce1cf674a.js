"use strict";(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[5095],{65095:(e,t,r)=>{r.r(t),r.d(t,{default:()=>A});var s=r(70314),a=r(36891),i=r(31435),n=r(19601),o=r(83905),c=r(27103),l=r(23615),m=r.n(l),d=(r(61418),r(14078),r(68581),r(52077),r(83526),r(1203),r(92189),r(84390)),u=r.n(d),g=r(11313),f=r(72060),h=r(65370),v=r(68679),p=r(43585),E=r(25598),T=r(77477),S=r(7249),b=r(26337),_=r(8243),y=r(23712),M=r(59220),O=r(88676);function w(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class R extends u().PureComponent{constructor(e){super(e),w(this,"getTermsOfService",(async()=>{this.setState({customTermsOfServiceId:"",customTermsOfServiceText:"",loading:!0});const{data:e}=await this.props.actions.getTermsOfService();e?this.setState({customTermsOfServiceId:e.id,customTermsOfServiceText:e.text,loading:!1}):v.gc("/login?extra=".concat(y.Constants.GET_TERMS_ERROR))})),w(this,"handleLogoutClick",(e=>{e.preventDefault(),v.gc("/login")})),w(this,"handleAcceptTerms",(()=>{this.setState({loadingAgree:!0,serverError:null}),this.registerUserAction(!0,(()=>{var e;const t=new URLSearchParams(null===(e=this.props.location)||void 0===e?void 0:e.search).get("redirect_to");t&&t.match(/^\/([^/]|$)/)?(0,_.s)().push(t):this.props.onboardingFlowEnabled?(0,_.s)().push("/"):v.mc()}))})),w(this,"handleRejectTerms",(()=>{this.setState({loadingDisagree:!0,serverError:null}),this.registerUserAction(!1,(()=>{v.gc("/login?extra=".concat(y.Constants.TERMS_REJECTED))}))})),w(this,"registerUserAction",(async(e,t)=>{const{data:r}=await this.props.actions.updateMyTermsOfServiceStatus(this.state.customTermsOfServiceId,e);r?t(r):this.setState({loadingAgree:!1,loadingDisagree:!1,serverError:u().createElement(f.FormattedMessage,{id:"terms_of_service.api_error",defaultMessage:"Unable to complete the request. If this issue persists, contact your System Administrator."})})})),this.state={customTermsOfServiceId:"",customTermsOfServiceText:"",loading:!0,loadingAgree:!1,loadingDisagree:!1,serverError:null},this.formattedText=(0,h.GA)((t=>(0,O.RZ)(t,{},e.emojiMap)))}componentDidMount(){this.props.termsEnabled?this.getTermsOfService():v.mc()}render(){if(this.state.loading)return u().createElement(E.Z,null);let e="terms-of-service__markdown";return this.state.serverError?e+=" terms-of-service-error__height--fill":e+=" terms-of-service__height--fill",u().createElement("div",{className:"signup-page-container"},u().createElement(p.default,null),u().createElement("div",{className:"signup-header"},u().createElement("a",{href:"#",onClick:this.handleLogoutClick},u().createElement(T.Z,null),u().createElement(f.FormattedMessage,{id:"web.header.logout",defaultMessage:"Logout"}))),u().createElement("div",{className:"signup-team__container terms-of-service__container"},u().createElement("div",{className:e},u().createElement("div",{className:"medium-center","data-testid":"termsOfService"},(0,M.Z)(this.formattedText(this.state.customTermsOfServiceText),{mentions:!1}))),u().createElement("div",{className:"terms-of-service__footer medium-center"},u().createElement("div",{className:"terms-of-service__button-group"},u().createElement(g.Button,{bsStyle:"primary",disabled:this.state.loadingAgree||this.state.loadingDisagree,id:"acceptTerms",onClick:this.handleAcceptTerms,type:"submit"},this.state.loadingAgree&&u().createElement(b.Z,null),u().createElement(f.FormattedMessage,{id:"terms_of_service.agreeButton",defaultMessage:"I Agree"})),u().createElement(g.Button,{bsStyle:"default",className:"btn-quaternary",disabled:this.state.loadingAgree||this.state.loadingDisagree,id:"rejectTerms",onClick:this.handleRejectTerms,type:"reset"},this.state.loadingDisagree&&u().createElement(b.Z,null),u().createElement(f.FormattedMessage,{id:"terms_of_service.disagreeButton",defaultMessage:"I Disagree"}))),Boolean(this.state.serverError)&&u().createElement("div",{className:"terms-of-service__server-error alert alert-warning"},u().createElement(S.Z,null)," ",this.state.serverError))))}}w(R,"propTypes",{termsEnabled:m().bool.isRequired,actions:m().shape({getTermsOfService:m().func.isRequired,updateMyTermsOfServiceStatus:m().func.isRequired}).isRequired,onboardingFlowEnabled:m().bool.isRequired});const A=(0,s.connect)((function(e){const t=(0,n.iE)(e);return{onboardingFlowEnabled:(0,o.g1)(e),termsEnabled:"true"===t.EnableCustomTermsOfService,emojiMap:(0,c.kM)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({getTermsOfService:i.Oi,updateMyTermsOfServiceStatus:i.oR},e)}}))(R)},77477:(e,t,r)=>{r.d(t,{Z:()=>n});var s=r(84390),a=r.n(s),i=r(72060);function n(){const{formatMessage:e}=(0,i.useIntl)();return a().createElement("i",{className:"fa fa-1x fa-angle-left",title:e({id:"generic_icons.logout",defaultMessage:"Logout Icon"})})}},7249:(e,t,r)=>{r.d(t,{Z:()=>d});var s=r(23615),a=r.n(s),i=r(60042),n=r.n(i),o=r(84390),c=r.n(o),l=r(72060);const m=e=>{let{additionalClassName:t}=e;const{formatMessage:r}=(0,l.useIntl)();return c().createElement("i",{className:n()("fa fa-warning",t),title:r({id:"generic_icons.warning",defaultMessage:"Warning Icon"})})};m.propTypes={additionalClassName:a().string};const d=c().memo(m)}}]);
//# sourceMappingURL=5095.a0589e2c103ce1cf674a.js.map