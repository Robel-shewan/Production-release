"use strict";(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[2166],{22166:(e,t,n)=>{n.d(t,{N8:()=>It,aW:()=>Ht,bd:()=>Rt});var a=n(70314),r=n(4500),s=n(43618),o=n(11298),i=n(23894),l=n(21349),c=n(33643),d=n(23712),m=n(70174),u=n(84390),h=n.n(u),p=n(13653);const E=()=>h().createElement(p.Z,{id:"channelHeaderDropdownMenu",ariaLabel:(0,m._u)("channel_header.menuAriaLabel","Channel Menu").toLowerCase()},h().createElement(Ht,{isMobile:!1})),C=(0,u.memo)(E);var g=n(23615),_=n.n(g),f=(n(92189),n(97042)),b=n(33115),y=n(71892),v=n(36891),N=n(73443),M=n(75627),A=n(40364),w=(n(14078),n(61418),n(72060)),T=n(85071),L=n(78197),I=n(40608),H=n(66475),R=n(38966);function P(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class S extends h().PureComponent{constructor(){super(...arguments),P(this,"loadItems",(async(e,t)=>{const{data:n}=await this.props.actions.getGroupsAssociatedToChannel(this.props.channel.id,t,e,L.i);return{items:n.groups,totalCount:n.totalGroupCount}})),P(this,"onClickRemoveGroup",((e,t)=>this.props.actions.unlinkGroupSyncable(e.id,this.props.channel.id,T.ZS.Channel).then((async()=>{t.setState({loading:!0});const{items:e,totalCount:n}=await t.props.loadItems(t.setState.page,t.state.searchTerm);t.setState({loading:!1,items:e,totalCount:n})})))),P(this,"onHide",(()=>{this.props.actions.closeModal(d.r8.MANAGE_CHANNEL_GROUPS)})),P(this,"titleButtonOnClick",(()=>{this.onHide(),this.props.actions.openModal({modalId:d.r8.ADD_GROUPS_TO_TEAM,dialogType:y.Z})})),P(this,"setChannelMemberStatus",(async(e,t,n)=>{this.props.actions.patchGroupSyncable(e.id,this.props.channel.id,T.ZS.Channel,{scheme_admin:n}).then((async()=>{t.setState({loading:!0});const{items:e,totalCount:n}=await t.props.loadItems(t.setState.page,t.state.searchTerm);await this.props.actions.getMyChannelMember(this.props.channel.id),t.setState({loading:!1,items:e,totalCount:n})}))})),P(this,"renderRow",((e,t)=>{let n;return n=e.scheme_admin?m._u("channel_members_dropdown.channel_admins","Channel Admins"):m._u("channel_members_dropdown.channel_members","Channel Members"),h().createElement("div",{key:e.id,className:"more-modal__row"},h().createElement("img",{className:"more-modal__image",src:R,alt:"group picture",width:"32",height:"32"}),h().createElement("div",{className:"more-modal__details"},h().createElement("div",{className:"more-modal__name"},e.display_name," ","-"," ",h().createElement("span",{className:"more-modal__name_count"},h().createElement(w.FormattedMessage,{id:"numMembers",defaultMessage:"{num, number} {num, plural, one {member} other {members}}",values:{num:e.member_count}})))),h().createElement("div",{className:"more-modal__actions"},h().createElement(H.Z,null,h().createElement("button",{id:"teamGroupsDropdown_".concat(e.display_name),className:"dropdown-toggle theme color--link style--none",type:"button","aria-expanded":"true"},h().createElement("span",null,n," "),h().createElement(I.Z,null)),h().createElement(p.Z,{openLeft:!0,ariaLabel:m._u("channel_members_dropdown.menuAriaLabel","Change the role of channel member")},h().createElement(p.Z.ItemAction,{show:!e.scheme_admin,onClick:()=>this.setChannelMemberStatus(e,t,!0),text:m._u("channel_members_dropdown.make_channel_admins","Make Channel Admins")}),h().createElement(p.Z.ItemAction,{show:Boolean(e.scheme_admin),onClick:()=>this.setChannelMemberStatus(e,t,!1),text:m._u("channel_members_dropdown.make_channel_members","Make Channel Members")}),h().createElement(p.Z.ItemAction,{onClick:()=>this.onClickRemoveGroup(e,t),text:m._u("group_list_modal.removeGroupButton","Remove Group")})))))}))}render(){const{formatMessage:e}=this.props.intl;return h().createElement(L.Z,{titleText:e({id:"channel_groups",defaultMessage:"{channel} Groups"},{channel:this.props.channel.display_name}),searchPlaceholderText:e({id:"manage_channel_groups_modal.search_placeholder",defaultMessage:"Search groups"}),renderRow:this.renderRow,loadItems:this.loadItems,onHide:this.onHide,titleBarButtonText:e({id:"group_list_modal.addGroupButton",defaultMessage:"Add Groups"}),titleBarButtonOnClick:this.titleButtonOnClick})}}P(S,"propTypes",{actions:_().shape({getGroupsAssociatedToChannel:_().func.isRequired,unlinkGroupSyncable:_().func.isRequired,patchGroupSyncable:_().func.isRequired,getMyChannelMember:_().func.isRequired,closeModal:_().func.isRequired,openModal:_().func.isRequired}).isRequired});const x=(0,w.injectIntl)(S),D=(0,a.connect)(((e,t)=>({channel:e.entities.channels.channels[t.channelID]})),(e=>({actions:(0,v.bindActionCreators)({getGroupsAssociatedToChannel:M.k0,closeModal:A.M,openModal:A.h,unlinkGroupSyncable:M.je,patchGroupSyncable:M.B2,getMyChannelMember:N.Or},e)})))(x);var O=n(11796),G=(n(95623),n(61514),n(45448)),k=n(20229),q=n(95849),Z=n(28176),B=n(46935),j=n(35590),F=n(76452);const V=e=>{const{formatMessage:t}=(0,w.useIntl)(),n=(0,a.useDispatch)(),r=(0,a.useSelector)(s.IU),i=(0,a.useSelector)((e=>e.views.channelSidebar.multiSelectedChannelIds)),l=(0,a.useSelector)(o.kA),c=(0,a.useSelector)((e=>l?(0,j.Yy)(e):void 0)),m=(0,a.useSelector)((t=>l?(0,q.Me)(t,(null==l?void 0:l.id)||"",e.channel.id):void 0));function u(){n((0,A.h)({modalId:d.r8.EDIT_CATEGORY,dialogType:F.default,dialogProps:{channelIdsToAdd:-1===i.indexOf(e.channel.id)?[e.channel.id]:i}})),(0,Z.L9)("ui","ui_sidebar_channel_menu_createCategory")}function E(a){return[...a.map((a=>{let r=a.display_name;return a.type===k.y.FAVORITES&&(r=t({id:"sidebar_left.sidebar_channel_menu.favorites",defaultMessage:"Favorites"})),a.type===k.y.CHANNELS&&(r=t({id:"sidebar_left.sidebar_channel_menu.channels",defaultMessage:"Channels"})),{id:"moveToCategory-".concat(e.channel.id,"-").concat(a.id),icon:a.type===k.y.FAVORITES?h().createElement(G.StarOutlineIcon,{size:16}):h().createElement(G.FolderOutlineIcon,{size:16}),direction:"right",text:r,action:()=>{return t=a.id,void((null==m?void 0:m.id)!==t&&(n((0,B.Q7)(t,e.channel.id)),(0,Z.L9)("ui","ui_sidebar_channel_menu_moveToExistingCategory")));var t}}})),{id:"ChannelMenu-moveToDivider",text:h().createElement("span",{className:"MenuGroup menu-divider"})},{id:"moveToNewCategory-".concat(e.channel.id),icon:h().createElement(G.FolderMoveOutlineIcon,{size:16}),direction:"right",text:t({id:"sidebar_left.sidebar_channel_menu.moveToNewCategory",defaultMessage:"New Category"}),action:u}]}function C(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e.filter((e=>e.type!==k.y.CHANNELS)):e.filter((e=>e.type!==k.y.DIRECT_MESSAGES))}return c?h().createElement(p.Z.Group,null,h().createElement(p.Z.ItemSubMenu,{id:"moveTo-".concat(e.channel.id),subMenu:function(t){const n=i.includes(e.channel.id);return e.inHeaderDropdown||!n?E(C(t,e.channel.type===d.default.DM_CHANNEL||e.channel.type===d.default.GM_CHANNEL)):i.every((e=>r[e].type===d.default.DM_CHANNEL||r[e].type===d.default.GM_CHANNEL))?E(C(t,!0)):i.every((e=>r[e].type!==d.default.DM_CHANNEL&&r[e].type!==d.default.GM_CHANNEL))?E(C(t,!1)):E(t.filter((e=>e.type!==k.y.CHANNELS&&e.type!==k.y.DIRECT_MESSAGES)))}(c),text:t({id:"sidebar_left.sidebar_channel_menu.moveTo",defaultMessage:"Move to..."}),direction:"right",icon:e.inHeaderDropdown?null:h().createElement(G.FolderMoveOutlineIcon,{size:16}),openUp:e.openUp,styleSelectableItem:!0,selectedValueText:null==m?void 0:m.display_name,renderSelected:!1})):null};V.propTypes={openUp:_().bool.isRequired,inHeaderDropdown:_().bool};const U=(0,u.memo)(V);var X=n(91213),z=n(11313),Y=n(2664);function W(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class $ extends h().PureComponent{constructor(e){super(e),W(this,"handleConvert",(()=>{const{actions:e,channelId:t}=this.props;t.length===d.default.CHANNEL_ID_LENGTH&&(e.updateChannelPrivacy(t,f.LQ.PRIVATE_CHANNEL),(0,Z.L9)("actions","convert_to_private_channel",{channel_id:t}),this.onHide())})),W(this,"onHide",(()=>{this.setState({show:!1})})),this.state={show:!0}}render(){const{channelDisplayName:e,onExited:t}=this.props;return h().createElement(z.Modal,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.onHide,onExited:t,role:"dialog","aria-labelledby":"convertChannelModalLabel"},h().createElement(z.Modal.Header,{closeButton:!0},h().createElement(z.Modal.Title,{componentClass:"h1",id:"convertChannelModalLabel"},h().createElement(w.FormattedMessage,{id:"convert_channel.title",defaultMessage:"Convert {display_name} to a Private Channel?",values:{display_name:e}}))),h().createElement(z.Modal.Body,null,h().createElement("p",null,h().createElement(Y.Z,{id:"convert_channel.question1",defaultMessage:"When you convert **{display_name}** to a private channel, history and membership are preserved. Publicly shared files remain accessible to anyone with the link. Membership in a private channel is by invitation only.",values:{display_name:e}})),h().createElement("p",null,h().createElement(w.FormattedMessage,{id:"convert_channel.question2",defaultMessage:"The change is permanent and cannot be undone."})),h().createElement("p",null,h().createElement(Y.Z,{id:"convert_channel.question3",defaultMessage:"Are you sure you want to convert **{display_name}** to a private channel?",values:{display_name:e}}))),h().createElement(z.Modal.Footer,null,h().createElement("button",{type:"button",className:"btn btn-tertiary",onClick:this.onHide},h().createElement(w.FormattedMessage,{id:"convert_channel.cancel",defaultMessage:"No, cancel"})),h().createElement("button",{type:"button",className:"btn btn-primary","data-dismiss":"modal",onClick:this.handleConvert,autoFocus:!0,"data-testid":"convertChannelConfirm"},h().createElement(w.FormattedMessage,{id:"convert_channel.confirm",defaultMessage:"Yes, convert to private channel"}))))}}W($,"propTypes",{channelDisplayName:_().string.isRequired,channelId:_().string.isRequired,onExited:_().func.isRequired,actions:_().shape({updateChannelPrivacy:_().func.isRequired}).isRequired});const J=(0,a.connect)(null,(function(e){return{actions:(0,v.bindActionCreators)({updateChannelPrivacy:N.CT},e)}}))($);var Q=n(83905),K=(n(20266),n(48410),n(60042)),ee=n.n(K),te=n(6098),ne=n(17534),ae=n(80806),re=n(26337),se=n(64996);const oe=()=>{const e=(0,w.useIntl)();return h().createElement(se.Z,{title:e.formatMessage({id:"sidebar_left.sidebar_channel_modal.no_common_teams_error.heading",defaultMessage:"Unable to convert to a channel because group members are part of different teams"}),text:e.formatMessage({id:"sidebar_left.sidebar_channel_modal.no_common_teams_error.body",defaultMessage:"Group Message cannot be converted to a channel because members are not a part of the same team. Add all members to a single team to convert this group message to a channel in that team."}),type:"danger"})};n(69217);var ie=n(1983),le=n(80623);const ce=e=>{const[t,n]=(0,u.useState)(),r=(0,w.useIntl)(),{formatMessage:s}=r,o=(0,u.useCallback)((t=>{const a=t.value;n(e.teamsById[a]),e.onChange(a)}),[]),i=(0,a.useSelector)(ie.B),l=Object.values(e.teamsById).map((e=>({value:e.id,label:e.display_name}))).sort(((e,t)=>e.label.localeCompare(t.label,i)));return h().createElement(le.Z,{className:"team_selector",required:!0,onChange:o,value:t?{label:t.display_name,value:t.id}:void 0,options:l,legend:s({id:"sidebar_left.sidebar_channel_modal.select_team_placeholder",defaultMessage:"Select Team"}),placeholder:s({id:"sidebar_left.sidebar_channel_modal.select_team_placeholder",defaultMessage:"Select Team"}),name:"team_selector"})};ce.propTypes={onChange:_().func.isRequired};const de=ce,me=e=>{const t=(0,w.useIntl)();let n;return n=e.channelMemberNames.length>0?t.formatList(e.channelMemberNames):t.formatMessage({id:"sidebar_left.sidebar_channel_modal.warning_body_yourself",defaultMessage:"yourself"}),h().createElement(se.Z,{title:t.formatMessage({id:"sidebar_left.sidebar_channel_modal.warning_header",defaultMessage:"Conversation history will be visible to any channel members"}),text:t.formatMessage({id:"sidebar_left.sidebar_channel_modal.warning_body",defaultMessage:"You are about to convert the Group Message with {memberNames} to a Channel. This cannot be undone."},{memberNames:n})})};me.propTypes={channelMemberNames:_().arrayOf(_().string).isRequired};const ue=me;var he=function(e){return e.CHANNEL_NAME_EXISTS="store.sql_channel.save_channel.exists.app_error",e}(he||{});const pe=e=>{const t=(0,w.useIntl)(),{formatMessage:n}=t,[r,s]=(0,u.useState)(""),o=(0,u.useRef)(""),[i,l]=(0,u.useState)(""),c=(0,u.useCallback)((e=>{o.current=e,l("")}),[]),[d,m]=(0,u.useState)([]);(0,u.useEffect)((()=>{const t=e.profilesInChannel.filter((t=>t.id!==e.currentUserId&&0===t.delete_at)).map((t=>(0,b.fw)(t,e.teammateNameDisplaySetting)));m(t)}),[e.profilesInChannel]);const[p,E]=(0,u.useState)({}),[C,g]=(0,u.useState)(!1),[_,f]=(0,u.useState)(!1),[y,v]=(0,u.useState)(),[N,M]=(0,u.useState)(!1),[A,T]=(0,u.useState)(),L=(0,a.useDispatch)(),I=(0,u.useRef)(!1);(0,u.useEffect)((()=>(I.current=!0,()=>{I.current=!1})),[]),(0,u.useEffect)((()=>{(async()=>{const t=await L((0,ne.sh)(e.channel.id));if(!I.current)return;if(t.error||!t.data)return;const n=t.data,a={};n.forEach((e=>{a[e.id]=e})),E(a),g(!0),1===n.length&&v(n[0].id)})(),setTimeout((()=>f(!0)),1200)}),[]);const H=(0,u.useCallback)((async()=>{if(!y)return;const{error:t}=await e.actions.convertGroupMessageToPrivateChannel(e.channel.id,y,r.trim(),o.current.trim());t?t.server_error_id===he.CHANNEL_NAME_EXISTS?l(n({id:"channel_modal.alreadyExist",defaultMessage:"A channel with that URL already exists"})):T(t.message):(T(void 0),(0,Z.L9)("actions","convert_group_message_to_private_channel",{channel_id:e.channel.id}),e.onExited())}),[y,e.channel.id,r,o.current,e.actions.moveChannelsInSidebar]),R=!C||!_,P=void 0!==y&&""!==r&&!N&&!i,S={};let x;if(R||0!==Object.keys(p).length){let t;S.handleCancel=R?void 0:e.onExited,S.isDeleteModal=!0,S.cancelButtonText=n({id:"channel_modal.cancel",defaultMessage:"Cancel"}),S.confirmButtonText=n({id:"sidebar_left.sidebar_channel_modal.confirmation_text",defaultMessage:"Convert to private channel"}),S.isConfirmDisabled=!P,t=R?h().createElement("div",{className:"loadingIndicator"},h().createElement(re.Z,null)):h().createElement(h().Fragment,null,h().createElement(ue,{channelMemberNames:d}),Object.keys(p).length>1&&h().createElement(de,{teamsById:p,onChange:v}),h().createElement(ae.Z,{value:r,name:"convert-gm-to-channel-modal-channel-name",placeholder:n({id:"sidebar_left.sidebar_channel_modal.channel_name_placeholder",defaultMessage:"Enter a name for the channel"}),autoFocus:!1,onDisplayNameChange:s,onURLChange:c,onErrorStateChange:M,team:y?p[y]:void 0,urlError:i}),A&&h().createElement("div",{className:"conversion-error"},h().createElement("i",{className:"icon icon-alert-outline"}),h().createElement("span",null,A))),x=h().createElement("div",{className:ee()({"convert-gm-to-channel-modal-body":!0,loading:R,"single-team":1===Object.keys(p).length,"multi-team":Object.keys(p).length>1})},t)}else S.confirmButtonText=n({id:"generic.okay",defaultMessage:"Okay"}),S.handleConfirm=e.onExited,x=h().createElement("div",{className:"convert-gm-to-channel-modal-body error"},h().createElement(oe,null));return h().createElement(te.$E,Object.assign({id:"convert-gm-to-channel-modal",className:"convert-gm-to-channel-modal",modalHeaderText:n({id:"sidebar_left.sidebar_channel_modal.header",defaultMessage:"Convert to Private Channel"}),compassDesign:!0,handleConfirm:R?void 0:H,onExited:e.onExited,autoCloseOnConfirmButton:!1},S),x)};pe.propTypes={onExited:_().func.isRequired,profilesInChannel:_().array.isRequired,teammateNameDisplaySetting:_().string.isRequired,currentUserId:_().string.isRequired};const Ee=pe,Ce=(0,a.connect)((function(){const e=(0,i.T5)();return(t,n)=>{const a=e(t,n.channel.id),r=(0,i.rc)(t);return{profilesInChannel:a,teammateNameDisplaySetting:(0,Q.kl)(t),currentUserId:r}}}),(function(e){return{actions:(0,v.bindActionCreators)({closeModal:A.M,convertGroupMessageToPrivateChannel:N.Pr,moveChannelsInSidebar:B.wv},e)}}))(Ee);var ge=n(19601),_e=n(9828),fe=n(8243);function be(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ye extends h().PureComponent{constructor(e){super(e),be(this,"handleDelete",(()=>{if(this.props.channel.id.length===d.default.CHANNEL_ID_LENGTH){if(!this.props.canViewArchivedChannels){const{penultimateViewedChannelName:e}=this.props;this.props.currentTeamDetails&&(0,fe.s)().push("/"+this.props.currentTeamDetails.name+"/channels/"+e)}this.props.actions.deleteChannel(this.props.channel.id),this.onHide()}})),be(this,"onHide",(()=>{this.setState({show:!1})})),this.state={show:!0}}render(){const{canViewArchivedChannels:e}=this.props;return h().createElement(z.Modal,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.onHide,onExited:this.props.onExited,role:"dialog","aria-labelledby":"deleteChannelModalLabel",id:"deleteChannelModal"},h().createElement(z.Modal.Header,{closeButton:!0},h().createElement(z.Modal.Title,{componentClass:"h1",id:"deleteChannelModalLabel"},h().createElement(w.FormattedMessage,{id:"delete_channel.confirm",defaultMessage:"Confirm ARCHIVE Channel"}))),h().createElement(z.Modal.Body,null,h().createElement("div",{className:"alert alert-danger"},!e&&h().createElement(Y.Z,{id:"delete_channel.question",defaultMessage:"This will archive the channel from the team and remove it from the user interface. Archived channels can be unarchived if needed again. \\n \\nAre you sure you wish to archive the {display_name} channel?",values:{display_name:this.props.channel.display_name}}),e&&h().createElement(Y.Z,{id:"delete_channel.viewArchived.question",defaultMessage:"This will archive the channel from the team. Channel contents will still be accessible by channel members.\n \nAre you sure you wish to archive the **{display_name}** channel?",values:{display_name:this.props.channel.display_name}}))),h().createElement(z.Modal.Footer,null,h().createElement("button",{type:"button",className:"btn btn-tertiary",onClick:this.onHide},h().createElement(w.FormattedMessage,{id:"delete_channel.cancel",defaultMessage:"Cancel"})),h().createElement("button",{type:"button",className:"btn btn-danger","data-dismiss":"modal",onClick:this.handleDelete,autoFocus:!0,id:"deleteChannelModalDeleteButton"},h().createElement(w.FormattedMessage,{id:"delete_channel.del",defaultMessage:"Archive"}))))}}be(ye,"propTypes",{onExited:_().func.isRequired,currentTeamDetails:_().shape({name:_().string.isRequired}),canViewArchivedChannels:_().bool,penultimateViewedChannelName:_().string.isRequired,actions:_().shape({deleteChannel:_().func.isRequired}).isRequired});const ve=(0,a.connect)((function(e){return{canViewArchivedChannels:"true"===(0,ge.iE)(e).ExperimentalViewArchivedChannels,currentTeamDetails:(0,o.kA)(e)}}),(function(e){return{actions:(0,v.bindActionCreators)({deleteChannel:_e.zz},e)}}))(ye);var Ne=n(34208),Me=n(34097),Ae=n(24036),we=n(19278),Te=n(41894),Le=(n(52077),n(911),n(34575));function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function He(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(n),!0).forEach((function(t){Re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Re(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Pe=(0,w.defineMessages)({maxLength:{id:"rename_channel.maxLength",defaultMessage:"This field must be less than {maxLength, number} characters"},url:{id:"rename_channel.url",defaultMessage:"URL"},defaultError:{id:"rename_channel.defaultError",defaultMessage:" - Cannot be changed for the default channel"}});class Se extends h().PureComponent{constructor(e){super(e),Re(this,"setError",(e=>{this.setState({serverError:e.message})})),Re(this,"unsetError",(()=>{this.setState({serverError:""})})),Re(this,"handleEntering",(()=>{this.textbox&&m.e6(this.textbox)})),Re(this,"handleHide",(e=>{e&&e.preventDefault(),this.setState({serverError:"",urlErrors:[],displayNameError:"",invalid:!1,show:!1})})),Re(this,"handleSubmit",(async e=>{e&&e.preventDefault();const t=Object.assign({},this.props.channel),n=t.name,a=t.display_name,r=He(He({},this.state),{},{serverError:""}),{formatMessage:s}=this.props.intl,{actions:{patchChannel:o}}=this.props;t.display_name=this.state.displayName.trim(),!t.display_name||t.display_name.length<d.default.MIN_CHANNELNAME_LENGTH?(r.displayNameError=h().createElement(w.FormattedMessage,{id:"rename_channel.minLength",defaultMessage:"Display name must have at least {minLength, number} characters.",values:{minLength:d.default.MIN_CHANNELNAME_LENGTH}}),r.invalid=!0):t.display_name.length>d.default.MAX_CHANNELNAME_LENGTH?(r.displayNameError=s(Pe.maxLength,{maxLength:d.default.MAX_CHANNELNAME_LENGTH}),r.invalid=!0):r.displayNameError="",t.name=this.state.channelName.trim();const i=(0,Te.pj)(t.name);if(i.length>0&&(r.invalid=!0),r.urlErrors=i,this.setState(r),r.invalid)return;if(n===t.name&&a===t.display_name)return void this.onSaveSuccess();const{data:l,error:c}=await o(t.id,t);l?this.onSaveSuccess():c&&this.setError(c)})),Re(this,"onSaveSuccess",(()=>{this.handleHide(),this.unsetError(),this.props.team&&(0,fe.s)().push("/"+this.props.team.name+"/channels/"+this.state.channelName)})),Re(this,"handleCancel",(e=>{this.setState({displayName:this.props.channel.display_name,channelName:this.props.channel.name}),this.handleHide(e)})),Re(this,"onNameChange",(e=>{const t=e.target.value.trim().replace(/[^A-Za-z0-9-_]/g,"").toLowerCase();this.setState({channelName:t})})),Re(this,"onDisplayNameChange",(e=>{this.setState({displayName:e.target.value})})),Re(this,"getTextbox",(e=>{this.textbox=e})),this.state={displayName:e.channel.display_name,channelName:e.channel.name,serverError:"",urlErrors:[],displayNameError:"",invalid:!1,show:!0}}render(){let e=null;this.state.displayNameError&&(e=h().createElement("p",{className:"input__help error"},this.state.displayNameError));let t=null,n=null,a="input-group input-group--limit";this.state.urlErrors.length>0?(t=h().createElement("p",{className:"input__help error"},this.state.urlErrors),a+=" has-error"):n=h().createElement("p",{className:"input__help"},h().createElement(w.FormattedMessage,{id:"change_url.helpText",defaultMessage:"You can use lowercase letters, numbers, dashes, and underscores."}));let r=null;this.state.serverError&&(r=h().createElement("div",{className:"form-group has-error"},h().createElement("label",{className:"control-label"},this.state.serverError)));const{formatMessage:s}=this.props.intl;let o=s(Pe.url),i=!1;this.props.channel.name===d.default.DEFAULT_CHANNEL&&(o+=s(Pe.defaultError),i=!0);const l=this.props.currentTeamUrl+"/channels",c="".concat((0,Te.ZC)(l,35),"/");return h().createElement(z.Modal,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.handleCancel,onEntering:this.handleEntering,onExited:this.props.onExited,role:"dialog","aria-labelledby":"renameChannelModalLabel"},h().createElement(z.Modal.Header,{closeButton:!0},h().createElement(z.Modal.Title,{componentClass:"h1",id:"renameChannelModalLabel"},h().createElement(w.FormattedMessage,{id:"rename_channel.title",defaultMessage:"Rename Channel"}))),h().createElement("form",{role:"form"},h().createElement(z.Modal.Body,null,h().createElement("div",{className:"form-group"},h().createElement("label",{className:"control-label"},h().createElement(w.FormattedMessage,{id:"rename_channel.displayName",defaultMessage:"Display Name"})),h().createElement("input",{onChange:this.onDisplayNameChange,type:"text",ref:this.getTextbox,id:"display_name",className:"form-control",placeholder:s({id:"rename_channel.displayNameHolder",defaultMessage:"Enter display name"}),value:this.state.displayName,maxLength:d.default.MAX_CHANNELNAME_LENGTH,"aria-label":s({id:"rename_channel.displayName",defaultMessage:"Display Name"}).toLowerCase()}),e),h().createElement("div",{className:"form-group"},h().createElement("label",{className:"control-label"},o),h().createElement("div",{className:a},h().createElement(Le.Z,{id:"renameChannelModalShortUrlTooltip",placement:"top",title:l},h().createElement("span",{className:"input-group-addon"},c)),h().createElement("input",{onChange:this.onNameChange,type:"text",className:"form-control",id:"channel_name",value:this.state.channelName,maxLength:d.default.MAX_CHANNELNAME_LENGTH,readOnly:i,"aria-label":s({id:"rename_channel.title",defaultMessage:"Rename Channel"}).toLowerCase()})),n,t),r),h().createElement(z.Modal.Footer,null,h().createElement("button",{type:"button",className:"btn btn-tertiary",onClick:this.handleCancel},h().createElement(w.FormattedMessage,{id:"rename_channel.cancel",defaultMessage:"Cancel"})),h().createElement("button",{onClick:this.handleSubmit,type:"submit",id:"save-button",className:"btn btn-primary"},h().createElement(w.FormattedMessage,{id:"rename_channel.save",defaultMessage:"Save"})))))}}const xe=(0,w.injectIntl)(Se);function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Oe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ge=(0,r.P1)("mapStateToPropsRenameChannel",(e=>{const t=e.entities.teams.currentTeamId,n=(0,o.VP)(e,t);return{currentTeamUrl:"".concat((0,Te.fO)(),"/").concat(n?n.name:""),team:n}}),(e=>function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){Oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))),ke=(0,a.connect)(Ge,(function(e){return{actions:(0,v.bindActionCreators)({patchChannel:N.aO},e)}}))(xe);function qe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ze extends h().PureComponent{constructor(e){super(e),qe(this,"handleUnarchive",(()=>{this.props.channel.id.length===d.default.CHANNEL_ID_LENGTH&&(this.props.actions.unarchiveChannel(this.props.channel.id),this.onHide())})),qe(this,"onHide",(()=>{this.setState({show:!1})})),this.state={show:!0}}render(){return h().createElement(z.Modal,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.onHide,onExited:this.props.onExited,role:"dialog","aria-labelledby":"unarchiveChannelModalLabel",id:"unarchiveChannelModal"},h().createElement(z.Modal.Header,{closeButton:!0},h().createElement(z.Modal.Title,{componentClass:"h1",id:"unarchiveChannelModalLabel"},h().createElement(w.FormattedMessage,{id:"unarchive_channel.confirm",defaultMessage:"Confirm UNARCHIVE Channel"}))),h().createElement(z.Modal.Body,null,h().createElement("div",{className:"alert alert-danger"},h().createElement(Y.Z,{id:"unarchive_channel.viewArchived.question",defaultMessage:"Are you sure you wish to unarchive the **{display_name}** channel?",values:{display_name:this.props.channel.display_name}}))),h().createElement(z.Modal.Footer,null,h().createElement("button",{type:"button",className:"btn btn-tertiary",onClick:this.onHide},h().createElement(w.FormattedMessage,{id:"unarchive_channel.cancel",defaultMessage:"Cancel"})),h().createElement("button",{type:"button",className:"btn btn-danger","data-dismiss":"modal",onClick:this.handleUnarchive,autoFocus:!0,id:"unarchiveChannelModalDeleteButton"},h().createElement(w.FormattedMessage,{id:"unarchive_channel.del",defaultMessage:"Unarchive"}))))}}qe(Ze,"propTypes",{onExited:_().func.isRequired,actions:_().shape({unarchiveChannel:_().func.isRequired}).isRequired});const Be=(0,a.connect)(null,(function(e){return{actions:(0,v.bindActionCreators)({unarchiveChannel:N.Ny},e)}}))(Ze);var je=n(12366);const Fe=e=>{let{isArchived:t,actions:n}=e;const a=(0,w.useIntl)();return h().createElement(p.Z.ItemAction,{show:t,onClick:n.goToLastViewedChannel,text:a.formatMessage({id:"center_panel.archived.closeChannel",defaultMessage:"Close Channel"})})};Fe.propTypes={isArchived:_().bool.isRequired,actions:_().shape({goToLastViewedChannel:_().func.isRequired}).isRequired};const Ve=h().memo(Fe),Ue=(0,a.connect)(null,(e=>({actions:(0,v.bindActionCreators)({goToLastViewedChannel:_e.NL},e)})))(Ve);var Xe=n(32394);function ze(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ye extends h().PureComponent{constructor(){super(...arguments),ze(this,"handleClose",(e=>{e.preventDefault();const{channel:t,currentUser:n,currentTeam:a,redirectChannel:r,actions:{savePreferences:s,leaveDirectChannel:o}}=this.props;let i,l;t.type===d.Constants.DM_CHANNEL?(l=d.Constants.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW,i=t.teammate_id):(l=d.Constants.Preferences.CATEGORY_GROUP_CHANNEL_SHOW,i=t.id),o(t.name),s(n.id,[{user_id:n.id,category:l,name:i,value:"false"}]),a&&(0,fe.s)().push("/".concat(a.name,"/channels/").concat(r))}))}render(){const{id:e,channel:t}=this.props;let n;return t.type===d.Constants.DM_CHANNEL?n=(0,m._u)("center_panel.direct.closeDirectMessage","Close Direct Message"):t.type===d.Constants.GM_CHANNEL&&(n=(0,m._u)("center_panel.direct.closeGroupMessage","Close Group Message")),h().createElement(p.Z.ItemAction,{id:e,show:t.type===d.Constants.DM_CHANNEL||t.type===d.Constants.GM_CHANNEL,onClick:this.handleClose,text:n})}}ze(Ye,"propTypes",{redirectChannel:_().string.isRequired,id:_().string,actions:_().shape({savePreferences:_().func.isRequired,leaveDirectChannel:_().func.isRequired}).isRequired});const We=(0,a.connect)((e=>({currentTeam:(0,o.kA)(e),redirectChannel:(0,s.fG)(e,(0,o.ev)(e))})),(e=>({actions:(0,v.bindActionCreators)({savePreferences:Xe.$A,leaveDirectChannel:_e.e2},e)})))(Ye);var $e=n(22319);const Je=e=>{let{isDefault:t=!0,isGuestUser:n=!1,channel:a,actions:{leaveChannel:r,openModal:s},id:o}=e;const i=(0,w.useIntl)(),l=(0,u.useCallback)((e=>{e.preventDefault(),a.type===d.Constants.PRIVATE_CHANNEL?s({modalId:d.r8.LEAVE_PRIVATE_CHANNEL_MODAL,dialogType:$e.Z,dialogProps:{channel:a}}):r(a.id)}),[a,r,s]);return h().createElement(p.Z.ItemAction,{id:o,show:(!t||n)&&a.type!==d.Constants.DM_CHANNEL&&a.type!==d.Constants.GM_CHANNEL,onClick:l,text:i.formatMessage({id:"channel_header.leave",defaultMessage:"Leave Channel"}),isDangerous:!0})};Je.propTypes={isDefault:_().bool.isRequired,isGuestUser:_().bool.isRequired,id:_().string};const Qe=(0,u.memo)(Je),Ke=(0,a.connect)(null,(function(e){return{actions:(0,v.bindActionCreators)({leaveChannel:_e.TL,openModal:A.h},e)}}))(Qe);var et=n(39183),tt=n(84459);const nt=e=>{let{show:t,id:n,channel:a,rhsOpen:r,text:s,editMembers:o=!1,actions:i}=e;return h().createElement(p.Z.ItemAction,{show:t,id:n,onClick:()=>{r||i.showChannelMembers(a.id,o)},text:s})};nt.propTypes={rhsOpen:_().bool.isRequired,actions:_().shape({showChannelMembers:_().func.isRequired}).isRequired,show:_().bool.isRequired,id:_().string.isRequired,editMembers:_().bool,text:_().string.isRequired};const at=nt,rt=(0,a.connect)((e=>({rhsOpen:(0,tt.aC)(e)&&(0,tt.kV)(e)===d.Hp.CHANNEL_MEMBERS})),(e=>({actions:(0,v.bindActionCreators)({showChannelMembers:et.yn},e)})))(at),st=e=>{let{show:t=!0,isFavorite:n,actions:{favoriteChannel:a,unfavoriteChannel:r},channel:s}=e;const o=(0,w.useIntl)(),i=(0,u.useCallback)((e=>n?r(e):a(e)),[n,a,r]),l=(0,u.useCallback)((e=>{e.preventDefault(),i(s.id)}),[s.id,i]);let c;return c=n?o.formatMessage({id:"channelHeader.removeFromFavorites",defaultMessage:"Remove from Favorites"}):o.formatMessage({id:"channelHeader.addToFavorites",defaultMessage:"Add to Favorites"}),h().createElement(p.Z.ItemAction,{show:t,onClick:l,text:c})},ot=(0,u.memo)(st),it=(0,a.connect)(null,(e=>({actions:(0,v.bindActionCreators)({favoriteChannel:N.ZE,unfavoriteChannel:N.Dn},e)})))(ot),lt=e=>{let{show:t,channel:n,rhsOpen:a,actions:r}=e;const s=a?(0,m._u)("channelHeader.hideInfo","Close Info"):(0,m._u)("channelHeader.viewInfo","View Info");return h().createElement(p.Z.ItemAction,{show:t,onClick:()=>{a?r.closeRightHandSide():r.showChannelInfo(n.id)},text:s})};lt.propTypes={show:_().bool.isRequired,rhsOpen:_().bool.isRequired,actions:_().shape({closeRightHandSide:_().func.isRequired,showChannelInfo:_().func.isRequired}).isRequired};const ct=lt,dt=(0,a.connect)((e=>({rhsOpen:(0,tt.aC)(e)&&(0,tt.kV)(e)===d.Hp.CHANNEL_INFO})),(e=>({actions:(0,v.bindActionCreators)({closeRightHandSide:et.Lg,showChannelInfo:et.P_},e)})))(ct);function mt(e){let{id:t,isMuted:n,channel:a,user:r,actions:s}=e;const o=(0,w.useIntl)(),i=(0,u.useCallback)((()=>{s.updateChannelNotifyProps(r.id,a.id,{mark_unread:n?d.XH.ALL:d.XH.MENTION})}),[s,n,r.id,a.id]);let l;return l=a.type===d.Constants.DM_CHANNEL||a.type===d.Constants.GM_CHANNEL?n?o.formatMessage({id:"channel_header.unmuteConversation",defaultMessage:"Unmute Conversation"}):o.formatMessage({id:"channel_header.muteConversation",defaultMessage:"Mute Conversation"}):n?o.formatMessage({id:"channel_header.unmute",defaultMessage:"Unmute Channel"}):o.formatMessage({id:"channel_header.mute",defaultMessage:"Mute Channel"}),h().createElement(p.Z.ItemAction,{id:t,onClick:i,text:l})}mt.propTypes={isMuted:_().bool.isRequired,id:_().string,actions:_().shape({}).isRequired};const ut=(0,a.connect)(null,(e=>({actions:(0,v.bindActionCreators)({updateChannelNotifyProps:N.n$},e)})))(mt),ht=e=>{let{channel:t,hasPinnedPosts:n,actions:{closeRightHandSide:a,showPinnedPosts:r},show:s}=e;const o=(0,w.useIntl)(),i=(0,u.useCallback)((e=>{e.preventDefault(),n?a():r(t.id)}),[t.id,a,r,n]);return h().createElement(p.Z.ItemAction,{show:s,onClick:i,text:o.formatMessage({id:"navbar.viewPinnedPosts",defaultMessage:"View Pinned Posts"})})},pt=(0,u.memo)(ht),Et=(0,a.connect)((e=>({hasPinnedPosts:(0,tt.kV)(e)===d.Hp.PIN})),(e=>({actions:(0,v.bindActionCreators)({closeRightHandSide:et.Lg,showPinnedPosts:et.B7},e)})))(pt);class Ct extends h().PureComponent{render(){const{user:e,channel:t,isDefault:n,isFavorite:a,isMuted:r,isReadonly:s,isArchived:o,isMobile:i,penultimateViewedChannelName:l,isLicensedForLDAPGroups:c}=this.props;if(!t)return null;const u=t.type===d.Constants.PRIVATE_CHANNEL,E=!0===t.group_constrained,C=u?f.Pl.MANAGE_PRIVATE_CHANNEL_MEMBERS:f.Pl.MANAGE_PUBLIC_CHANNEL_MEMBERS,g=u?f.Pl.MANAGE_PRIVATE_CHANNEL_PROPERTIES:f.Pl.MANAGE_PUBLIC_CHANNEL_PROPERTIES,_=u?f.Pl.DELETE_PRIVATE_CHANNEL:f.Pl.DELETE_PUBLIC_CHANNEL,v=f.Pl.MANAGE_TEAM;let N;i&&(N=h().createElement("li",{className:"MenuGroup mobile-menu-divider"},h().createElement("hr",null)));const M=this.props.pluginMenuItems.map((e=>h().createElement(p.Z.ItemAction,{id:e.id+"_pluginmenuitem",key:e.id+"_pluginmenuitem",onClick:()=>{e.action&&e.action(t.id)},text:e.text})));return h().createElement(h().Fragment,null,h().createElement(dt,{show:t.type!==d.Constants.DM_CHANNEL&&t.type!==d.Constants.GM_CHANNEL,channel:t}),h().createElement(U,{channel:t,openUp:!1,inHeaderDropdown:!0}),h().createElement(p.Z.Group,{divider:N},h().createElement(it,{show:i,channel:t,isFavorite:a}),h().createElement(Et,{show:i,channel:t}),h().createElement(p.Z.ItemToggleModalRedux,{id:"channelNotificationPreferences",show:t.type!==d.Constants.DM_CHANNEL&&!o,modalId:d.r8.CHANNEL_NOTIFICATIONS,dialogType:X.Z,dialogProps:{channel:t,currentUser:e},text:(0,m._u)("navbar.preferences","Notification Preferences")}),h().createElement(ut,{id:"channelToggleMuteChannel",user:e,channel:t,isMuted:r})),h().createElement(p.Z.Group,{divider:N},h().createElement(we.Z,{channelId:t.id,teamId:t.team_id,permissions:[C]},h().createElement(p.Z.ItemToggleModalRedux,{id:"channelAddMembers",show:t.type!==d.Constants.DM_CHANNEL&&t.type!==d.Constants.GM_CHANNEL&&!o&&!n&&!E,modalId:d.r8.CHANNEL_INVITE,dialogType:O.Z,dialogProps:{channel:t},text:(0,m._u)("navbar.addMembers","Add Members")}),h().createElement(p.Z.ItemToggleModalRedux,{id:"channelAddMembers",show:t.type===d.Constants.GM_CHANNEL&&!o&&!E,modalId:d.r8.CREATE_DM_CHANNEL,dialogType:Ae.default,dialogProps:{isExistingChannel:!0},text:(0,m._u)("navbar.addMembers","Add Members")})),h().createElement(rt,{id:"channelViewMembers",channel:t,show:t.type!==d.Constants.DM_CHANNEL&&t.type!==d.Constants.GM_CHANNEL&&(o||n),text:(0,m._u)("channel_header.viewMembers","View Members")}),h().createElement(we.Z,{channelId:t.id,teamId:t.team_id,permissions:[C]},h().createElement(p.Z.ItemToggleModalRedux,{id:"channelAddGroups",show:t.type!==d.Constants.DM_CHANNEL&&t.type!==d.Constants.GM_CHANNEL&&!o&&!n&&E&&c,modalId:d.r8.ADD_GROUPS_TO_CHANNEL,dialogType:y.Z,text:(0,m._u)("navbar.addGroups","Add Groups")}),h().createElement(p.Z.ItemToggleModalRedux,{id:"channelManageGroups",show:t.type!==d.Constants.DM_CHANNEL&&t.type!==d.Constants.GM_CHANNEL&&!o&&!n&&E&&c,modalId:d.r8.MANAGE_CHANNEL_GROUPS,dialogType:D,dialogProps:{channelID:t.id},text:(0,m._u)("navbar_dropdown.manageGroups","Manage Groups")}),h().createElement(rt,{id:"channelManageMembers",channel:t,show:t.type!==d.Constants.DM_CHANNEL&&t.type!==d.Constants.GM_CHANNEL&&!o&&!n,text:(0,m._u)("channel_header.manageMembers","Manage Members"),editMembers:!o})),h().createElement(we.Z,{channelId:t.id,teamId:t.team_id,permissions:[C],invert:!0},h().createElement(rt,{id:"channelViewMembers",channel:t,show:t.type!==d.Constants.DM_CHANNEL&&t.type!==d.Constants.GM_CHANNEL&&!o&&!n,text:(0,m._u)("channel_header.viewMembers","View Members")}))),h().createElement(p.Z.Group,{divider:N},h().createElement(p.Z.ItemToggleModalRedux,{id:"channelEditHeader",show:!(t.type!==d.Constants.DM_CHANNEL&&t.type!==d.Constants.GM_CHANNEL||o||s),modalId:d.r8.EDIT_CHANNEL_HEADER,dialogType:Ne.Z,dialogProps:{channel:t},text:(0,m._u)("channel_header.setConversationHeader","Edit Conversation Header")}),h().createElement(p.Z.ItemToggleModalRedux,{id:"convertGMPrivateChannel",show:t.type===d.Constants.GM_CHANNEL&&!o&&!s&&!(0,b.nJ)(e.roles),modalId:d.r8.CONVERT_GM_TO_CHANNEL,dialogType:Ce,dialogProps:{channel:t},text:(0,m._u)("sidebar_left.sidebar_channel_menu_convert_to_channel","Convert to Private Channel")})),h().createElement(p.Z.Group,{divider:N},h().createElement(we.Z,{channelId:t.id,teamId:t.team_id,permissions:[g]},h().createElement(p.Z.ItemToggleModalRedux,{id:"channelEditHeader",show:t.type!==d.Constants.DM_CHANNEL&&t.type!==d.Constants.GM_CHANNEL&&!o&&!s,modalId:d.r8.EDIT_CHANNEL_HEADER,dialogType:Ne.Z,dialogProps:{channel:t},text:(0,m._u)("channel_header.setHeader","Edit Channel Header")}),h().createElement(p.Z.ItemToggleModalRedux,{id:"channelEditPurpose",show:!o&&!s&&t.type!==d.Constants.DM_CHANNEL&&t.type!==d.Constants.GM_CHANNEL,modalId:d.r8.EDIT_CHANNEL_PURPOSE,dialogType:Me.Z,dialogProps:{channel:t},text:(0,m._u)("channel_header.setPurpose","Edit Channel Purpose")}),h().createElement(p.Z.ItemToggleModalRedux,{id:"channelRename",show:!o&&t.type!==d.Constants.DM_CHANNEL&&t.type!==d.Constants.GM_CHANNEL,modalId:d.r8.RENAME_CHANNEL,dialogType:ke,dialogProps:{channel:t},text:(0,m._u)("channel_header.rename","Rename Channel")})),h().createElement(we.Z,{channelId:t.id,teamId:t.team_id,permissions:[f.Pl.CONVERT_PUBLIC_CHANNEL_TO_PRIVATE]},h().createElement(p.Z.ItemToggleModalRedux,{id:"channelConvertToPrivate",show:!o&&!n&&t.type===d.Constants.OPEN_CHANNEL,modalId:d.r8.CONVERT_CHANNEL,dialogType:J,dialogProps:{channelId:t.id,channelDisplayName:t.display_name},text:(0,m._u)("channel_header.convert","Convert to Private Channel")})),h().createElement(Ke,{id:"channelLeaveChannel",channel:t,isDefault:n,isGuestUser:(0,b.nJ)(e.roles)}),h().createElement(we.Z,{channelId:t.id,teamId:t.team_id,permissions:[_]},h().createElement(p.Z.ItemToggleModalRedux,{id:"channelArchiveChannel",show:!o&&!n&&t.type!==d.Constants.DM_CHANNEL&&t.type!==d.Constants.GM_CHANNEL,modalId:d.r8.DELETE_CHANNEL,className:"MenuItem__dangerous",dialogType:ve,dialogProps:{channel:t,penultimateViewedChannelName:l},text:(0,m._u)("channel_header.delete","Archive Channel")})),i&&h().createElement(je.Z,{channel:t,isDropdown:!0}),h().createElement(We,{id:"channelCloseMessage",channel:t,currentUser:e}),h().createElement(Ue,{isArchived:o})),h().createElement(p.Z.Group,null,M),h().createElement(p.Z.Group,{divider:N},h().createElement(we.Z,{channelId:t.id,teamId:t.team_id,permissions:[v]},h().createElement(p.Z.ItemToggleModalRedux,{id:"channelUnarchiveChannel",show:o&&!n&&t.type!==d.Constants.DM_CHANNEL&&t.type!==d.Constants.GM_CHANNEL,modalId:d.r8.UNARCHIVE_CHANNEL,dialogType:Be,dialogProps:{channel:t},text:(0,m._u)("channel_header.unarchive","Unarchive Channel")}))))}}var gt,_t,ft;gt=Ct,_t="propTypes",ft={isDefault:_().bool.isRequired,isFavorite:_().bool.isRequired,isReadonly:_().bool.isRequired,isMuted:_().bool.isRequired,isArchived:_().bool.isRequired,isMobile:_().bool.isRequired,penultimateViewedChannelName:_().string.isRequired,pluginMenuItems:_().array.isRequired,isLicensedForLDAPGroups:_().bool.isRequired},(_t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(_t))in gt?Object.defineProperty(gt,_t,{value:ft,enumerable:!0,configurable:!0,writable:!0}):gt[_t]=ft;var bt=n(3073),yt=n(82365);const vt={enter:350,exit:350},Nt=e=>{let{show:t,children:n}=e;return h().createElement(yt.Z,{in:t,classNames:"mobile-channel-header-dropdown",enter:!0,exit:!0,mountOnEnter:!0,unmountOnExit:!0,timeout:vt},n)},Mt=h().memo(Nt),At=e=>{let{user:t,channel:n,teammateId:a,displayName:r,teammateIsBot:s,teammateStatus:o}=e;const i=(0,w.useIntl)();let l;return s||(l=h().createElement(bt.Z,{status:o})),h().createElement(H.Z,{animationComponent:Mt},h().createElement("a",null,h().createElement("span",{className:"heading"},l,n?n.type===d.Constants.DM_CHANNEL?t.id===a?h().createElement(w.FormattedMessage,{id:"channel_header.directchannel.you",defaultMessage:"{displayname} (you)",values:{displayname:r}}):r:n.display_name:""),h().createElement("span",{className:"fa fa-angle-down header-dropdown__icon",title:i.formatMessage({id:"generic_icons.dropdown",defaultMessage:"Dropdown Icon"})})),h().createElement(p.Z,{ariaLabel:i.formatMessage({id:"channel_header.menuAriaLabel",defaultMessage:"Channel Menu"})},h().createElement(Ht,{isMobile:!0}),h().createElement("div",{className:"Menu__close visible-xs-block"},"×")))};At.propTypes={teammateId:_().oneOfType([_().string,_().oneOf([null])]),teammateIsBot:_().bool,teammateStatus:_().string,displayName:_().string.isRequired};const wt=(0,u.memo)(At),Tt=(0,r.P1)("getTeammateId",s.TB,i.rc,((e,t)=>(null==e?void 0:e.type)!==d.Constants.DM_CHANNEL?null:m.uD(e.name,t))),Lt=(0,r.P1)("getTeammateStatus",i.aH,Tt,((e,t)=>{if(t)return e[t]})),It=C,Ht=(0,a.connect)((e=>({user:(0,i.ts)(e),channel:(0,s.TB)(e),isDefault:(0,s.r4)(e),isFavorite:(0,s.CA)(e),isMuted:(0,s.D7)(e),isReadonly:!1,isArchived:(0,s.Vl)(e),penultimateViewedChannelName:(0,l.TS)(e)||(0,s.fG)(e,(0,o.ev)(e)),pluginMenuItems:(0,c.DB)(e),isLicensedForLDAPGroups:"true"===e.entities.general.license.LDAPGroups})))(Ct),Rt=(0,a.connect)((e=>{const t=(0,i.ts)(e),n=(0,s.TB)(e),a=Tt(e);let r=!1,o="";if(a){const t=(0,i.PR)(e,a);r=t&&t.is_bot,o=m.hI(e,t)}return{user:t,channel:n,teammateId:a,teammateIsBot:r,teammateStatus:Lt(e),displayName:o}}))(wt)},64996:(e,t,n)=>{n.d(t,{Z:()=>h});var a=n(23615),r=n.n(a),s=n(60042),o=n.n(s),i=n(84390),l=n.n(i),c=n(72060),d=n(27468);const m={info:"icon-information-outline",success:"icon-check",danger:"icon-alert-outline",warning:"icon-alert-outline",welcome:void 0},u=e=>{let{title:t,text:n,primaryButton:a,secondaryButton:r,linkButton:s,type:i="info",isDismissable:u,onDismissClick:h}=e;const p=(0,c.useIntl)(),E=m[i],C=Boolean(u&&h),g="btn btn-sm sectionNoticeButton";return l().createElement("div",{className:o()("sectionNoticeContainer",i)},l().createElement("div",{className:"sectionNoticeContent"},E&&l().createElement("i",{className:o()("icon sectionNoticeIcon",E,i)}),l().createElement("div",{className:"sectionNoticeBody"},l().createElement("h4",{className:o()("sectionNoticeTitle",{welcome:"welcome"===i})},t),l().createElement(d.Z,{message:n}),l().createElement("div",{className:"sectionNoticeActions"},a&&l().createElement("button",{onClick:a.onClick,className:o()(g,"btn-primary")},a.text),r&&l().createElement("button",{onClick:r.onClick,className:o()(g,"btn-secondary")},r.text),s&&l().createElement("button",{onClick:s.onClick,className:o()(g,"btn-link")},s.text)))),C&&l().createElement("button",{className:"btn btn-icon btn-sm sectionNoticeClose",onClick:h,"aria-label":p.formatMessage({id:"sectionNotice.dismiss",defaultMessage:"Dismiss notice"})},l().createElement("i",{className:"icon icon-close"})))};u.propTypes={title:r().string.isRequired,text:r().string.isRequired,primaryButton:r().shape({onClick:r().func.isRequired,text:r().string.isRequired}),secondaryButton:r().shape({onClick:r().func.isRequired,text:r().string.isRequired}),linkButton:r().shape({onClick:r().func.isRequired,text:r().string.isRequired}),type:r().oneOf(["info","success","danger","welcome","warning"]),isDismissable:r().bool,onDismissClick:r().func};const h=u},12366:(e,t,n)=>{n.d(t,{Z:()=>b});var a=n(70314),r=n(36891),s=n(54146),o=n(4586),i=n(43618),l=n(83905),c=n(30961),d=n(23615),m=n.n(d),u=(n(14078),n(61418),n(92189),n(84390)),h=n.n(u),p=n(72060),E=n(98831);function C(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class g extends h().PureComponent{constructor(){super(...arguments),C(this,"createAppButton",(e=>{const t=()=>this.fireAppAction(e);return this.props.isDropdown?h().createElement("li",{key:"mobileChannelHeaderItem"+e.app_id+e.location,role:"presentation",className:"MenuItem"},h().createElement("a",{role:"menuitem",href:"#",onClick:t},e.label)):h().createElement("li",{className:"flex-parent--center"},h().createElement("button",{id:"".concat(e.app_id,"_").concat(e.location),className:"navbar-toggle navbar-right__icon",onClick:t},h().createElement("span",{className:"icon navbar-plugin-button"},h().createElement("img",{src:e.icon,width:"16",height:"16"}))))})),C(this,"createButton",(e=>{const t=()=>this.fireAction(e);return this.props.isDropdown?h().createElement("li",{key:"mobileChannelHeaderItem"+e.id,role:"presentation",className:"MenuItem"},h().createElement("a",{role:"menuitem",href:"#",onClick:t},e.dropdownText)):h().createElement("li",{className:"flex-parent--center"},h().createElement("button",{className:"navbar-toggle navbar-right__icon",onClick:t},h().createElement("span",{className:"icon navbar-plugin-button"},e.icon)))})),C(this,"fireAppAction",(async e=>{const{channel:t,intl:n}=this.props,a=(0,E.qM)(e.app_id,e.location,t.id,t.team_id),r=await this.props.actions.handleBindingClick(e,a,n);if(r.error){const e=r.error,a=e.text||n.formatMessage({id:"apps.error.unknown",defaultMessage:"Unknown error occurred."});return void this.props.actions.postEphemeralCallResponseForChannel(e,a,t.id)}const o=r.data;switch(o.type){case s.Bp.OK:o.text&&this.props.actions.postEphemeralCallResponseForChannel(o,o.text,t.id);break;case s.Bp.NAVIGATE:break;case s.Bp.FORM:o.form&&this.props.actions.openAppsModal(o.form,a);break;default:{const e=this.props.intl.formatMessage({id:"apps.error.responses.unknown_type",defaultMessage:"App response type not supported. Response type: {type}."},{type:o.type});this.props.actions.postEphemeralCallResponseForChannel(o,e,t.id)}}}))}createList(e){return e.map(this.createButton)}createAppList(e){return e.map(this.createAppButton)}fireAction(e){var t;return null===(t=e.action)||void 0===t?void 0:t.call(e,this.props.channel,this.props.channelMember)}render(){const e=this.props.components||[],t=this.props.appBindings||[];if(0===e.length&&0===t.length)return null;if(1===e.length&&0===t.length)return this.createButton(e[0]);if(0===e.length&&1===t.length)return this.createAppButton(t[0]);if(!this.props.isDropdown)return null;const n=this.createList(e),a=this.createAppList(t);return h().createElement(h().Fragment,null,n,a)}}C(g,"propTypes",{components:m().array,isDropdown:m().bool.isRequired,appBindings:m().array.isRequired,appsEnabled:m().bool.isRequired,actions:m().shape({}).isRequired});const _=(0,p.injectIntl)(g),f=(0,o.WG)(s.NR.CHANNEL_HEADER_ICON),b=(0,a.connect)((function(e){const t=(0,o.D8)(e);return{appBindings:f(e),appsEnabled:t,channelMember:(0,i.HU)(e),components:e.plugins.components.MobileChannelHeaderButton,theme:(0,l.gh)(e)}}),(function(e){return{actions:(0,r.bindActionCreators)({handleBindingClick:c.eL,postEphemeralCallResponseForChannel:c.H7,openAppsModal:c.HN},e)}}))(_)}}]);
//# sourceMappingURL=2166.6aa683be36a31a3ac9e0.js.map